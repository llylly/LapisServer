{% include "head.html" %}

{% load static %}

<link href="{% static "site_css/main.css" %}" rel="stylesheet">
<script src="{% static "site_js/main.js" %}"></script>
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>

<div class="mainpage-container">

    <div class="mainpage-filediv">
        <div class="row text-center">
            <h4>我的脚本</h4>
        </div>
        <div class="row">
            <a href="#" class="btn btn-primary btn-block" style="margin:5pt;" id="new_file_trigger_btn">新脚本</a>
            <a href="#" class="btn btn-primary btn-block" style="margin:5pt;" id="import_trigger_btn">导入</a>
            <input type="text" class="input-block-level search-query" style="margin:5pt;" placeholder="搜索" id="filelist_search">
        </div>
        <div class="mainpage-filelist">
        </div>
    </div>

    <div class="mainpage-leftdiv">

        <div class="row" style="padding: 10pt; margin-left: 0">
{#            <div class="span2 form-group">#}
{#                <input class="input-file" style="display: inline" id="fileInput" type="file">#}
{#            </div>#}
            <label class="btn btn-default btn-file" style="width: 40pt">
                上传 <input type="file" style="display: none;" id="fileInput">
            </label>
            <span class="text-center" style="width: calc(100% - 65pt); display: inline-block" id="filename_div">
                <a id="filename_span" href="#">Noname</a>
                <span id="filename_astar">*</span>
            </span>
{#            <div class="span2 pull-right" style="margin-left: 0">#}
{#                <a class="btn btn-primary btn-block" id="file_btn">Load</a>#}
{#            </div>#}
        </div>

        <div class="tabbable tabs-below" id="script_area_frame">
            <div class="tab-content" id="script_area_subframe">
                <div class="tab-pane active" id="script_area"></div>
                <div class="tab-pane" id="transed_script_area"></div>
            </div>
            <ul class="nav nav-tabs">
                <li class="active">
                    <a href="#script_area" data-toggle="tab" class="codetabs">YAML</a>
                </li>
                <li id="xml_tab">
                    <a href="#transed_script_area" data-toggle="tab" id="xml_toggle_btn" class="codetabs">XML（只读）</a>
                </li>
            </ul>
        </div>

        <div class="row" style="margin: 10pt">
{#            <span style="float: left; margin-left: 0">#}
{#                Script format: <br>#}
{#                <input type="radio" name='format_type' id="YAML-radio" checked>&nbsp;YAML or JSON#}
{#                <input type="radio" name='format_type' id="XML-radio" style="margin-left: 20pt">&nbsp;XML#}
{#            </span>#}
            <span class="span2 pull-right" style="margin-right: 0; margin-left: 0">
                <a class="btn btn-primary btn-block" id="parse_btn">解析</a>
                <a class="btn btn-success btn-block" id="save_btn">保存</a>
            </span>
        </div>

{#        <div class="row" style="margin: 10pt">#}
{#            <div class="span2" style="margin-left: 0">#}
{#                <input type="radio" name='format_type' id="YAML-radio" checked>&nbsp;YAML or JSON#}
{#            </div>#}
{#            <div class="span1" style="margin-left: 0">#}
{#                <input type="radio" name='format_type' id="XML-radio">&nbsp;XML#}
{#            </div>#}
{#            <div class="span2 pull-right" style="margin-left: 0">#}
{#                <a class="btn btn-primary btn-block" id="parse_btn">Parse</a>#}
{#            </div>#}
{#        </div>#}

{#        <div class="row" style="padding-left: 10pt; padding-right: 10pt" >#}
{#            <a class="parse_status span1" id="doc_status" data-toggle="tooltip" title="Document Parse">#}
{#                <span class="badge badgenormal">Stage 1</span>#}
{#                <span class="badge badge-success">Stage 1</span>#}
{#                <span class="badge badge-important">Stage 1</span>#}
{#            </a>#}
{#            <a class="parse_status span1" id="api_status" data-toggle="tooltip" title="API Parse">#}
{#                <span class="badge badgenormal">Stage 2</span>#}
{#                <span class="badge badge-success">Stage 2</span>#}
{#                <span class="badge badge-important">Stage 2</span>#}
{#            </a>#}
{#        </div>#}

{#        <div class="row" style="padding-left: 10pt; padding-right: 10pt" >#}
{#            <div class="span2 pull-right" style="margin-right: 0pt">#}
{#                <a class="btn btn-success btn-block" id="save_btn">Save</a>#}
{#            </div>#}
{#        </div>#}

    </div>

    <div class="mainpage-rightdiv">

        <div class="panel panel-null text-warning" id="change_div">
            <div class="panel-body">
                检测到更改。请重新解析。
                <hr>
            </div>
        </div>

        <div class="panel panel-null panel-body" id="error_panel">
            <h5>错误</h5>
            <div style="height: 5px"></div>
            <div id="error_list" style="color: darkred">
                没有错误。
            </div>
        </div>

{#        <div class="panel panel-null" id="transform_ops">#}
{#            <div class="panel-body">#}
{#                <div class="row">#}
{#                    <div style="width: 30%; margin-left: 70%">#}
{#                        <a id="transform_btn" class="btn btn-primary btn-block btn-success">Transform to Another Format</a>#}
{#                    </div>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}

        <div class="panel panel-null" id="basic_info_panel">
            <div class="panel-heading">
                <a href="#" data-toggle="collapse" data-target="#basic_info_body">基本信息</a>
            </div>
            <div class="panel-body collapse in" id="basic_info_body">
                <table class="table">
                    <tbody id="basic_info_table">

                    </tbody>
                </table>
            </div>
        </div>

        <div class="panel panel-null" id="api_panel">
            <div class="panel-heading">
                <a data-toggle="collapse" data-target="#api_list" href="#">API列表</a>
            </div>
            <div class="panel-body">
                <div id="api_list" class="collapse in">
                </div>
            </div>
        </div>

    </div>


    <div id="copy_modal" class="modal hide fade in" style="display: none; ">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">×</a>
            <h3>原始JSON数据</h3>
        </div>
        <div class="modal-body">
            <div id="json_area" style="max-height: 300pt; word-break:break-all; overflow-y: scroll"></div>
        </div>
        <div class="modal-footer">
            <a href="#" class="btn" data-dismiss="modal">关闭</a>
        </div>
    </div>

    <div id="chgfilename_modal" class="modal hide fade in" style="display: none; ">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">×</a>
            <h3>更改名称</h3>
        </div>
        <div class="modal-body">
            <input class="span5" type="text" id="chgfilename_input" placeholder="New Document Name" />
            <div class="help-block">不需包含扩展名（.yaml/.xml）。</div>
        </div>
        <div class="modal-footer">
            <a href="#" class="btn btn-success" id="chgfilename_btn">更改</a>
            <a href="#" class="btn" data-dismiss="modal">取消</a>
        </div>
    </div>

    <div class="modal hide" id="waitDialog" data-backdrop="static" data-keyboard="false">
        <div class="modal-header">
            <h1>加载中...</h1>
        </div>
        <div class="modal-body">
            <div class="progress progress-striped active">
                <div class="bar" style="width: 100%;"></div>
            </div>
        </div>
    </div>

    <div id="delconfirm_modal" class="modal hide fade in" style="display: none; ">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">×</a>
            <h3>删除确认</h3>
        </div>
        <div class="modal-body">
            您确认要删除文件"<span class="text-error" id="delconfirm_filename"></span>"吗？
        </div>
        <div class="modal-footer">
            <a href="#" class="btn btn-danger" id="delconfirm_btn">删除</a>
            <a href="#" class="btn" data-dismiss="modal">关闭</a>
        </div>
    </div>

    <div id="rename_modal" class="modal hide fade in" style="display: none; ">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">×</a>
            <h3>更改名称</h3>
        </div>
        <div class="modal-body">
            <input class="span5" type="text" id="rename_input" placeholder="New Document Name" />
            <div class="help-block">不需包含扩展名（.yaml/.xml）。</div>
        </div>
        <div class="modal-footer">
            <a href="#" class="btn btn-success" id="rename_btn">更改</a>
            <a href="#" class="btn" data-dismiss="modal">取消</a>
        </div>
    </div>

    <div id="newfile_modal" class="modal hide fade in" style="display: none">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">×</a>
            <h3>新脚本</h3>
        </div>
        <div class="modal-body">
            <div id="newfile_danger_div">
                <span class="text-danger">
                    <strong>编辑器中的脚本正在编辑。确定要覆盖吗？</strong>
                </span>
            </div>
            <br>
            新脚本名称：<br>
            <input class="span5" type="text" id="newfile_input" />
            <div class="help-block">不需包含扩展名（.yaml/.xml）。</div>
        </div>
        <div class="modal-footer">
            <a href="#" class="btn btn-success" id="newfile_btn">新建</a>
            <a href="#" class="btn" data-dismiss="modal">取消</a>
        </div>
    </div>

    <div id="import_modal" class="modal hide fade in" style="display: none">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">x</a>
            <h3>导入</h3>
        </div>
        <div class="modal-body">
            支持YAML格式单脚本导入和ZIP批量导入。
            <br>
            批量导入时，递归提取包中所有YAML脚本。
            <br>
            大小限制：10
            <br>
            <span class="text-danger">
                <strong>已有的重名脚本将被导入脚本覆盖。</strong>
            </span>
            <hr>
            <div class="btn-group">
                <label class="input-group-btn" style="display: inline">
                    <span class="btn btn-primary">
                        浏览&hellip; <input type="file" style="display: none;" multiple id="import_fileInput">
                    </span>
                </label>
                <input type="text" class="form-control" readonly id="import_fileInputShow">
            </div>
        </div>
        <div class="modal-footer">
            <a href="#" class="btn btn-success" id="import_btn">导入</a>
            <a href="#" class="btn" data-dismiss="modal">取消</a>
        </div>
    </div>

    <form id="transForm" action="#" style="display: None" target="_blank" method="get">

    </form>

</div>

{% include "tail.html" %}